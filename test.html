<!DOCTYPE HTML>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A simple example</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pannellum@2.5.6/build/pannellum.css" />
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/pannellum@2.5.6/build/pannellum.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="src/jquery.wayfinding.min.js"></script>

    <style>
        * {
            padding: 0;
            margin: 0;
        }

        #panorama {
            width: 100vw;
            height: 100vh;
        }

        #map {
            display: none;
            width: 100vw;
            height: 100vh;
        }
    </style>
</head>

<body>
    <div id="map"></div>
    <div id="panorama"></div>
    <script>
        const panel = pannellum.viewer('panorama', {
            "default": {
                "firstScene": "firstroom",
                "sceneFadeDuration": 1000
            },
            "scenes": {
                "firstroom": {
                    "hfov": 110,
                    "pitch": -3,
                    "yaw": 15,
                    "type": "equirectangular",
                    "panorama": "./test3.jpg",
                    "hotSpots": [
                        {
                            "pitch": -15.4,
                            "yaw": 380.6,
                            "cssClass": "custom-hotspot",
                            "createTooltipFunc": hotspot,
                            "type": "scene",
                            "sceneId": "secondroom",
                            "targetYaw": -130,
                            "targetPitch": -8

                        },

                    ]
                },

                "secondroom": {
                    "hfov": 110,
                    "yaw": 5,
                    "type": "equirectangular",
                    "panorama": "./test.jpg",
                    "hotSpots": [
                        {
                            "pitch": -20,
                            "yaw": 15.1,
                            "type": "scene",
                            "cssClass": "custom-hotspot",
                            "createTooltipFunc": hotspot,
                            "sceneId": "firstroom",
                            "targetYaw": -175,
                            "targetPitch": -8
                        }
                    ]
                }
            },
        }).on('mousedown', function () {
            console.log('yaw = ' + panel.getYaw() + '\n' + 'pitch = ' + panel.getPitch());
        });
        function hotspot(hotSpotDiv, args) {
            hotSpotDiv.classList.add('custom-tooltip');
            var span = document.createElement('svg');
            span.innerHTML = '<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg  viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns"> <title>arrow-up-circle</title>    <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage"><g id="Icon-Set" sketch:type="MSLayerGroup" transform="translate(-360.000000, -1087.000000)" fill="currentColor">       <path d="M376,1117 C368.268,1117 362,1110.73 362,1103 C362,1095.27 368.268,1089 376,1089 C383.732,1089 390,1095.27 390,1103 C390,1110.73 383.732,1117 376,1117 L376,1117 Z M376,1087 C367.163,1087 360,1094.16 360,1103 C360,1111.84 367.163,1119 376,1119 C384.837,1119 392,1111.84 392,1103 C392,1094.16 384.837,1087 376,1087 L376,1087 Z M376.879,1096.46 C376.639,1096.22 376.311,1096.15 376,1096.21 C375.689,1096.15 375.361,1096.22 375.121,1096.46 L369.465,1102.12 C369.074,1102.51 369.074,1103.14 369.465,1103.54 C369.854,1103.93 370.488,1103.93 370.879,1103.54 L375,1099.41 L375,1110 C375,1110.55 375.447,1111 376,1111 C376.553,1111 377,1110.55 377,1110 L377,1099.41 L381.121,1103.54 C381.512,1103.93 382.145,1103.93 382.535,1103.54 C382.926,1103.14 382.926,1102.51 382.535,1102.12 L376.879,1096.46 L376.879,1096.46 Z" id="arrow-up-circle" sketch:type="MSShapeGroup"></path>        </g>    </g></svg>';
            hotSpotDiv.appendChild(span);
            $('.custom-tooltip svg svg').width(100)
            $('.custom-tooltip svg svg').height(100)
            $('.custom-tooltip svg svg').css('transform', 'rotateX(40deg)');
            $('.custom-tooltip svg svg').css('cursor', 'pointer');
            $('.custom-tooltip svg svg').css('color', 'white');
            span.style.marginLeft = -(span.scrollWidth - hotSpotDiv.offsetWidth) / 2 + 'px';
            span.style.marginTop = -span.scrollHeight - 12 + 'px';
        }
        $(document).ready(function () {
            'use strict';
            $('#map').wayfinding({
                'maps': [
                    { 'path': 'test/fixtures/try.svg', 'id': 'floor1' },
                    { 'path': 'test/fixtures/demo_map_2.svg', 'id': 'floor2' }
                ],
                'path': {
                    width: 3,
                    color: 'red',
                    radius: 8,
                    speed: 0
                },
                'startpoint': function () {
                    return 'R103';
                },
                'defaultMap': 'floor1',
                'showLocation': false,
                'zoomToRoute': false,
            }, function () {
                console.log('callback reached');
            });
        })
    </script>

</body>

</html>